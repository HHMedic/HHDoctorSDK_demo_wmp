<!--components/hh-trtc/hh-trtc.wxml-->
<view class="page-room">
	<view hidden='{{isEvaluate}}'>
		<trtc-room id="trtc-component" 
		config="{{rtcConfig}}" 		
		patient-status='{{patientStatus}}'
		patient-name='{{patientName}}'
		orderid='{{orderid}}' 
		order='{{order}}' 
		localVideoStatus='{{_request.localVideoStatus}}'
		doctor='{{doctor}}'
		phase='{{phase}}'
		></trtc-room>
		<view style='background-image:url(https://imgs.hh-medic.com/icon/wmp/bg-default.jpg)' class='page-bg'  wx:if='{{phase!=phaseStatus.CALLING}}'>
		</view>
		<!-- 过渡页0 -->
		<phase-a style='display:{{phase==phaseStatus.TRANSFER?"block":"none"}}'></phase-a>
		<!-- 呼叫中1 -->
		<phase-b style='display:{{phase==phaseStatus.RINGING?"block":"none"}}' isAuthBox='{{isAuthBox}}' doctor='{{doctor}}' callTips='{{callTips}}' bind:hangUp='bindHangUp'></phase-b>
		<!-- 排队中2 -->
		<phase-c style='display:{{phase==phaseStatus.QUEUE?"block":"none"}}' callTips='{{callTips}}' doctor='{{doctor}}' isEnterWaitRoom='{{isEnterWaitRoom}}'  bind:hangUp='bindHangUp' bindchangedoctor="exitWaitRoomAndCall" waitTips='{{waitTips}}' ></phase-c>
		<!-- 观看小视频6 -->
		<block wx:if='{{phase==phaseStatus.VIDEO_AD}}'>
			<hh-live request="{{_request}}"  class="hh-live"  bindclose="_onCloseVideo" bindinputcomment="_onInputComment"></hh-live>
			<!-- <view class='room-modal-wait'>
			  <view class='wait-text'>{{waitTips.waitUserInfoText? waitTips.waitUserInfoText:'目前咨询人数较多，感谢耐心等待'}}</view>
			  <view class='wait-icon' catchtap='bindHangUp'></view>
			</view> -->
		</block>
		<!-- 视频中3 -->
		<phase-d  
			style='display:{{phase==phaseStatus.CALLING?"block":"none"}}'
			doctor='{{doctor}}' 
			cameraTorch='{{cameraTorch}}'
			order='{{order}}'
			is-auth='{{isAuth}}'
			patient-name="{{realPatientName}}"
			patient-uuid="{{realPatientUuid}}"
			patient-user-token="{{realPatientUserToken}}"
			videoTime='{{videoTime}}' 
			videoTimeSeconds='{{videoTimeSeconds}}'
     		expertAudio='{{expertAudio}}'
      		systeminfo='{{systeminfo}}'
			request='{{_request}}'
			remote-user-count='{{remoteUserCount}}'
			bind:hangUp='bindHangUp'  
			bind:enterCamera='bindEnterCamera'
			bind:completeCamera='bindCompleteCamera'
			bind:changeCamera='bindSwitchCamera'
			bind:toggleTorch='bindToggleTorch'
			bind:changeDoctor = 'bindChangeDoctor'
			bind:invite="requestPip"
			id='trtcCamera'
			></phase-d>
		<!-- 医生回拨4 -->
		<phase-e style='display:{{phase==phaseStatus.DOCTOR_CALL?"block":"none"}}' doctor='{{doctor}}' isInvite='{{_request.isInvite}}' order='{{order}}' bind:hangUp='bindHangUp' bind:accept='bindAccept'></phase-e>
		<!-- 专家回拨5 -->
		<phase-f style='display:{{phase==phaseStatus.EXPERT_CALL?"block":"none"}}' doctor='{{doctor}}' isInvite='{{_request.isInvite}}' order='{{order}}' bind:hangUp='bindHangUp' bind:accept='bindAccept'></phase-f>
		<!-- 多人视频 被邀请人 邀请页7 -->
		<phase-g style='display:{{phase==phaseStatus.INVITED?"block":"none"}}' doctor='{{doctor}}' isInvite='{{_request.isInvite}}' order='{{order}}' bind:hangUp='bindInviteHangUp' bind:accept='bindInviteAccept'></phase-g>
		<!-- 专家视频提前进房 -->
		<phase-h style='display:{{phase==phaseStatus.EXPERT_WAIT?"block":"none"}}' order='{{order}}' bind:cancel='bindCancel'></phase-h>
		<showToast style='display:{{isShowToast?"block":"none"}}' toastTitle='{{toastTitle}}'></showToast>
		<!-- 未授权弹窗 -->
		<block wx:if='{{isAuthBox}}'>
		  <cover-view class='auth-box' >
		    <cover-view class='auth-text'>您未授权小程序使用您的麦克风或摄像头，无法使用相应功能</cover-view>
		    <button class='auth-button' open-type="openSetting" >现在去授权</button>
		    <button class='auth-button' catchtap='bindAuthButton'>我已授权，重新呼叫</button>	
		  </cover-view>
		</block>
	</view>
	<view class="hide-tip-wrap" wx:if='{{isHideTip&&phase==phaseStatus.CALLING}}' catchtap='bindCloseHideTip'>
		<text class="hide-tip-text">请不要离开此界面，以防视频中断</text></view>
	<view class='evaluate-box' wx:if='{{isEvaluate}}'>
	  <hh-evaluate 
	  request='{{_request}}'
	  evaluateData='{{evaluateData}}' 
	  famOrderId='{{orderid}}' 
	  doctor='{{doctor}}'
	  bind:closeevalate="_closeEvaluate"
	  ></hh-evaluate>
	</view>
    <trtc-modal title='{{modal.title}}' content='{{modal.content}}' isExitWx='{{modal.isExitWx}}' wx:if='{{isShowModalTip}}' bind:trtcModalConfirm='bindTrtcModalConfirm'></trtc-modal>
</view>

<web-view wx:if="{{whiteboardVisible}}" src="{{whiteboardUrl}}"></web-view>