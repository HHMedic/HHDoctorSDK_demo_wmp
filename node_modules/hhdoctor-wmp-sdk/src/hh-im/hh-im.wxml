<wxs src="../wxs/common.wxs" module="common" />
<import src="./cards.wxml" />

<view class='main-container' style='padding-top:{{sysInfo.statusBarHeight}}px' >
   <hh-calling
   msgPanelTop='{{msgPanelTop}}'
   navigationBar='{{navigationBar}}'
   wxMbb='{{wxMbb}}'
   navStyle='{{navStyle}}'
   customStyle='{{customStyle}}'
   request='{{_request}}'
   basePath='{{basePath}}'
   disConnected='{{disConnected}}'
   demoStatusInit='{{demoStatusInit}}'
   bind:livePanelHeight='bindLivePanelHeight'
   sysInfo='{{sysInfo}}'
   bind:onWsClose='bindOnWsClose'
   class='hhcalling'
   bind:memberList='getMemberList'
   manyVideo='{{manyVideo}}'
   product='{{product}}' 
   ></hh-calling>
	<!-- 中部消息列表 -->
	<scroll-view class='msg-panel-scroll'
		style='top:{{msgPanelTop+livePanelHeight}}px;height:{{msgPanelHeight-livePanelHeight}}px;' scroll-y
		scroll-into-view='{{lastMsgId}}' 
		catchtap='bindScrollView'
		>
		<block wx:for='{{msgList}}' wx:for-item='msg' wx:key='msg'>
			<view class='msg-row timestamp'>
				<text class='msg-time'>{{msg.timeText}}</text>
			</view>
			<block wx:if='{{"text"==msg.type}}'>
				<template is='msgText'
					data='{{...msg,asst:_request.style.asst,basePath,userToken,sdkProductId}}'></template>
			</block>
			<block wx:if='{{"image"==msg.type}}'>
				<template is='msgImg' data='{{...msg,asst:_request.style.asst}}'></template>
			</block>

			<block wx:if='{{"audio"==msg.type}}'>
				<template is='msgAudio' data='{{...msg,asst:_request.style.asst}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "summaryByFam"==msg.bodyContent.command}}'>
				<template is='msgCardSummary'
					data='{{...msg,ehrPage:_request.ehrPage,title:_request.style.card.summaryTitle}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "buyDrugInformation"==msg.bodyContent.command}}'>
				<template is='msgCardMed'
					data='{{...msg,title:_request.style.card.medTitle,btnStyle:customStyle.mainBtn}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "videoAdv"==msg.bodyContent.command}}'>
				<template is='msgCardVideoAdv' data='{{...msg,title:_request.style.card.videoAdvTitle}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "buyService"==msg.bodyContent.command}}'>
				<template is='msgCardBuy' data='{{...msg,title:_request.style.card.buyServiceTitle}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "commandProductTips"==msg.bodyContent.command}}'>
				<template is='msgCardServiceTip' data='{{...msg}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "psycholTips"==msg.bodyContent.command}}'>
				<template is='msgCardTips' data='{{...msg}}'></template>
			</block>

			<block
				wx:if='{{"card"==msg.type && ("psycholForm"==msg.bodyContent.command ||"psycholFeedback"==msg.bodyContent.command)}}'>
				<template is='msgCardPsychol' data='{{...msg}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "command_recomment_doctor"==msg.bodyContent.command}}'>
				<template is='msgCardRecommentDoctor' data='{{...msg}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "appointmentExpertSuccess"==msg.bodyContent.command}}'>
				<template is='msgCardExpert' data='{{...msg}}'></template>
			</block>
			<block wx:if='{{"card"==msg.type && "nurseReport"==msg.bodyContent.command}}'>
				<template is='nurseReport' data='{{...msg}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "nurseDetail"==msg.bodyContent.command}}'>
				<template is='nurseDetail' data='{{...msg}}'></template>
			</block>
			<block wx:if='{{"card"==msg.type &&"drugProductUser"==msg.bodyContent.command}}'>
				<template is='drugActive' data='{{...msg}}'></template>
			</block>
			<block wx:if='{{"card"==msg.type &&"drugNoProductUser"==msg.bodyContent.command}}'>
				<template is='drugActive' data='{{...msg}}'></template>
			</block>
			<block wx:if='{{"card"==msg.type &&"drugOrderHangUp"==msg.bodyContent.command}}'>
				<template is='drugActive' data='{{...msg}}'></template>
			</block>
			<block wx:if='{{"card"==msg.type &&"commandNetHospitalRx"==msg.bodyContent.command}}'>
				<template is='netHospitalRx' data='{{...msg}}'></template>
			</block>
			<block wx:if='{{"card"==msg.type &&"welcomeTips"==msg.bodyContent.command}}'>
				<template is='webcomeTips' data='{{...msg}}'></template>
			</block>
			<block wx:if='{{"card"==msg.type &&("fastchannel"==msg.bodyContent.command ||"nurse_home"==msg.bodyContent.command||"hao"==msg.bodyContent.command)}}'>
				<template is='appointmentItem' data='{{...msg}}'></template>
			</block>

			<block wx:if='{{"card"==msg.type && "hao_detail"==msg.bodyContent.command||"fastchannel_detail"==msg.bodyContent.command||"nurse_home_detail"==msg.bodyContent.command}}'>
				<template is='appointmentItemDetail' data='{{...msg}}'></template>
			</block>
			 <!-- <block>
			 	<template is='equity' data='{{...msg}}'></template>
			 </block> -->
			<!-- <block>
				<template is='msgCardExpert' data='{{...msg}}'></template>
			</block> -->
		</block>

	</scroll-view>
	<hh-bottom 
	id='hhBottom'
	wx:if="{{_request.bottomToolsVisible}}"
	request='{{_request}}'
	manyVideo='{{manyVideo}}'
  	product='{{product}}'
	safeAreaHight='{{safeAreaHight}}'
	memberList='{{memberList}}'
	bind:sendTextMsg='bindSendTextMsg' 
	bind:sendAudio='bindSendAudio'
	bind:everyIcon = 'bindEveryIcon'
	bind:isShowToolBar = 'bindIsShowToolBar'
	bind:keyboardheightchange='bindkeyboardheightchange'
	></hh-bottom>
</view>
<realName wx:if="{{isShowRealName}}" bind:closeRealName="bindCloseRealName" 
bind:realNameSuccess="bindRealNameSuccess"
realNameMsg="{{realNameMsg}}"></realName>
<hh-Modal isShowModal='{{isShowModal}}' wx:if='{{isShowModal}}' modalData="{{modalMsgData}}"
bind:myConfirm='_bindMyConfirm' bind:myCancel='_bindMyCancel' data-type='{{modalMsgData.source}}'></hh-Modal>

<block wx:if='{{isEnterFace}}'>
	<hh-face sysInfo='{{sysInfo}}' patient='{{patient}}' parent='{{parent}}' bind:closeFace='bindCloseFaceVerify'
		bind:beginFaceVerify='bindBeginFaceVerify' bind:continue='bindContinue'></hh-face>
</block>
